Board <%= board.title %> ( <%=: board.type | capitalize %> )

<ul>Your lists:
  <% for(var i= 0, l= lists.length; i < l; i++) {%>
    <li>
      <div><%= lists[i].name %></div>
    </li>
  <%}%>
  <li>
    <div id="add-new-list">
      <span>Add new list</span>
      <span id="addListFormWrapper" hidden>
        <form id="addListForm" method=POST action="#">
          <label for="name">New list name:</label><input id="name" type="text" name="name" />
          <input type="hidden" name="board" value="<%= board.hash %>" />
          <input type="submit" value="Add" />
        </form>
        <button id="hide-add-button-form">X</button>
      </span>
    </div>
  </li>
</ul>

<a href="/user/">Back</a>

<script type="text/javascript">
  var formElement = document.querySelector("#addListForm");
  var addListDivElement = document.querySelector("#add-new-list");
  var hideFormElement = document.querySelector("#hide-add-button-form");

  function toggleVisibilityAddListForm(e){
    addListDivElement.children[0].hidden = !addListDivElement.children[0].hidden;
    addListDivElement.children[1].hidden = !addListDivElement.children[1].hidden;
    addListDivElement.onclick = addListDivElement.onclick === null ? toggleVisibilityAddListForm : null;
    e.stopPropagation();
  }

  function addListSubmit() {
    io.socket.post(
      '/list/add',
      {name:this.name.value, board: this.board.value},
      function(res,jres){
        if(res.message) {
          alert(res.message);
        }
        if(jres.statusCode === 200) {
          window.location = window.location;
        }
      });
    return false;
  }

  formElement.onsubmit = addListSubmit;
  addListDivElement.onclick = toggleVisibilityAddListForm;
  hideFormElement.onclick = toggleVisibilityAddListForm;

</script>
